<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>the gnarly tyke</title>
    <link rel="stylesheet" href="stylesheets/default.css">
</head>
<body>
  <h1 class="main-header">the gnarly tyke</h1>
  <div>
    <h2 class="area-name">Scar Buttress at Baildon Bank</h2>
  </div>
  <div>
    <img id="topo-image" src="./images/scar-wall-resize.jpg" style="display:none;">
  </div>
  <div style="margin-top: 2%;">
    <canvas style="margin: auto; display: block" id="topo-canvas"></canvas>
  </div>
  <div style="margin-top: 2%;">
    <table class="route-table" id="route-table" style="width: 80%; margin: auto">
      <thead>
          <tr>
            <th></th>
            <th>Name</th>
            <th>Type</th>
            <th>Grade</th>
          </tr>
      </thead>
      <tbody id="route-table-body">
        <script>
          let routes = 
          [
            { "name": "Scar Wall", "type": "Trad", "grade": "E5 6b" },
            { "name": "Scar", "type": "Trad", "grade": "E2 5b" },
            { "name": "The Flakes", "type": "Trad", "grade": "E3 5c" },
            { "name": "Intrepid", "type": "Trad", "grade": "E6 6a" }
          ];
          routes.forEach((route, index) => {
            let rowHTML = 
            `<tr>
              <td>${index+1}</td>
              <td>${route.name}</td>
              <td>${route.type}</td>
              <td>${route.grade}</td>
            </tr>
            `;
            document.write(rowHTML);
          });
        </script>
      </tbody>
    </table>
  </div>
  <script>
    window.onload = function() {
      DrawTopo();
    }
    window.onresize = () => {
      DrawTopo();
    }
    let DrawTopo = () => {
      var canvas = document.getElementById("topo-canvas");
      var ctx = canvas.getContext("2d");
      var img = document.getElementById("topo-image");
      const imageWidthToHeightRatio = img.height / img.width;
      canvas.width = window.innerWidth * 80 / 100;
      canvas.height = canvas.width * imageWidthToHeightRatio;
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      const labels = [
      { "value": 1, "x": 30, "y": 80 },
      { "value": 2, "x": 45, "y": 80 },
      { "value": 3, "x": 55, "y": 80 },
      { "value": 4, "x": 62, "y": 80 }
      ]
      labels.forEach( label => {
        DrawLabel(ctx, label.x, label.y, label.value);
      });
    }
    let DrawLabel = (ctx, xPos, yPos, index) => {
      const xPosOnCanvas = ctx.canvas.width * xPos / 100;
      const yPosOnCanvas = ctx.canvas.height * yPos / 100;
      const size = ctx.canvas.width * 1.2 / 100;
      const fontSize = size * 2;
      ctx.beginPath();
      ctx.arc(xPosOnCanvas, yPosOnCanvas, size, 0, 2 * Math.PI, false);
      ctx.fillStyle = "#FFFFFF";
      ctx.fill();
      ctx.beginPath();
      ctx.arc(xPosOnCanvas, yPosOnCanvas, size, 0, 2 * Math.PI, false);
      ctx.lineWidth = size * 10 / 100;
      ctx.strokeStyle = "#000000";
      ctx.stroke();
      ctx.font = `bold ${fontSize}px serif`;
      ctx.fon
      ctx.fillStyle = "#000000";
      ctx.fillText(index, xPosOnCanvas - (size / 2), yPosOnCanvas + (size * 3 / 4));
    }
    </script>
</body>
</html>
