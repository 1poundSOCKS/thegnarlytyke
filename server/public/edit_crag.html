<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>the gnarly tyke</title>
    <link rel="stylesheet" href="stylesheets/default.css">
</head>
<body>
  <script src="./common.js"></script>
  <h1>the gnarly tyke</h1>
  <div>
    <h2>edit crag</h2>
  </div>
  <div id="topo-images" class="topo-images"></div>
  <script>
    let _crag = null;
    window.onload = () => {
      fetch('./get_crag')
      .then(response => response.json())
      .then(crag => {
        console.log(JSON.stringify(crag));
        _crag = crag;
        _crag.topos.forEach( topo => {
          let imageFile = topo.imageFile;
          console.log(`image file: ${imageFile}`);
          LoadImage(`./get_image?filename=${imageFile}`)
          .then( topoImage => {
            console.log(`image loaded: width=${topoImage.width}, height=${topoImage.height}`);
            let topoImagesContainer = document.getElementById('topo-images');
            let canvas = document.createElement('CANVAS');
            canvas.setAttribute('class', 'topo-image');
            canvas.setAttribute('height', 200);
            canvas.setAttribute('width', topoImage.width * 200 / topoImage.height);
            let topoCanvas = topoImagesContainer.appendChild(canvas);
            let ctx = topoCanvas.getContext('2d');
            ctx.drawImage(topoImage, 0, 0, topoCanvas.width, topoCanvas.height);
          });
        });
      });
    }
    window.onresize = () => {
    }
    </script>
</body>
</html>
